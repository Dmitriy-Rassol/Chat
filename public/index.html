<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" href="./images/favicon.ico" type="image/x-icon" />
    <title>Socket.IO chat</title>
    <style>
      body {
        margin: 0;
        padding-bottom: 3rem;
        font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
          Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue",
          sans-serif;
      }

      #form {
        background: rgba(0, 0, 0, 0.15);
        padding: 0.5rem;
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        display: flex;
        height: 3rem;
        box-sizing: border-box;
        backdrop-filter: blur(10px);
      }

      #input {
        border: none;
        width: 100%;
        padding: 0 1rem;
        margin-right: 1rem;
        border-radius: 15px;
        outline: none;
      }

      #form > button {
        background: #333;
        border: none;
        padding: 0 1rem;
        border-radius: 10px;
        outline: none;
        color: #fff;
      }

      #messages {
        list-style-type: none;
        margin: 0;
        padding: 0;
      }
      #messages > li {
        padding: 0.5rem 1rem;
      }

      #messages > li:nth-child(odd) {
        background: #efefef;
      }
    </style>
  </head>
  <body>
    <ul id="messages"></ul>
    <form action="" id="form">
      <input autocomplete="off" id="input" />
      <button>Send</button>
    </form>
    <script
      src="https://cdn.socket.io/4.7.4/socket.io.min.js"
      integrity="sha384-Gr6Lu2Ajx28mzwyVR8CFkULdCU7kMlZ9UthllibdOSo6qAiN+yXNHqtgdTvFXMT4"
      crossorigin="anonymous"
    ></script>

    <script>
      const sleep = (ms) => new Promise((resolve) => setTimeout(resolve, ms));

      async function go1() {
        const socket = io("ws://localhost:9000");
        socket.on("message", (payload) => console.log("message", payload));
        socket.emit("join", { id: "hello" });
        await sleep(4000);
        socket.emit("send", { to: "hello", message: "from first" }, (payload) =>
          console.log("from send to Hello", payload)
        );
      }

      async function go2() {
        const socket = io("ws://localhost:9001");
        socket.on("message", (payload) => console.log("message", payload));
        socket.emit("join", { id: "hello" });
        socket.emit("join", { id: "bye" });
        await sleep(5000);

        socket.emit(
          "send",
          { to: "hello", message: "from second" },
          (payload) => console.log("from send to Bye", payload)
        );
      }

      async function go3() {
        const socket = io("ws://localhost:9002");
        socket.on("message", (payload) => console.log("message", payload));
        socket.emit("join", { id: "bye" });
        await sleep(5000);

        socket.emit("send", { to: "bye", message: "from third" }, (payload) =>
          console.log("from send to Bye", payload)
        );
      }
    </script>
  </body>
</html>
